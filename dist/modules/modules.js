"use strict";var source=(()=>{var ue=Object.create;var S=Object.defineProperty;var le=Object.getOwnPropertyDescriptor;var ce=Object.getOwnPropertyNames;var de=Object.getPrototypeOf,pe=Object.prototype.hasOwnProperty;var u=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports),ge=(e,r)=>{for(var t in r)S(e,t,{get:r[t],enumerable:!0})},F=(e,r,t,i)=>{if(r&&typeof r=="object"||typeof r=="function")for(let n of ce(r))!pe.call(e,n)&&n!==t&&S(e,n,{get:()=>r[n],enumerable:!(i=le(r,n))||i.enumerable});return e};var fe=(e,r,t)=>(t=e!=null?ue(de(e)):{},F(r||!e||!e.__esModule?S(t,"default",{value:e,enumerable:!0}):t,e)),Ie=e=>F(S({},"__esModule",{value:!0}),e);var q=u(w=>{"use strict";Object.defineProperty(w,"__esModule",{value:!0})});var U=u(O=>{"use strict";var Oe=O&&O.__createBinding||(Object.create?function(e,r,t,i){i===void 0&&(i=t);var n=Object.getOwnPropertyDescriptor(r,t);(!n||("get"in n?!r.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return r[t]}}),Object.defineProperty(e,i,n)}:function(e,r,t,i){i===void 0&&(i=t),e[i]=r[t]}),Ee=O&&O.__exportStar||function(e,r){for(var t in e)t!=="default"&&!Object.prototype.hasOwnProperty.call(r,t)&&Oe(r,e,t)};Object.defineProperty(O,"__esModule",{value:!0});Ee(q(),O)});var H=u(D=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0});D.MochiRequestMethod=void 0;var $;(function(e){e.get="get",e.post="post",e.put="put",e.patch="patch"})($||(D.MochiRequestMethod=$={}))});var V=u(E=>{"use strict";var _e=E&&E.__createBinding||(Object.create?function(e,r,t,i){i===void 0&&(i=t);var n=Object.getOwnPropertyDescriptor(r,t);(!n||("get"in n?!r.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return r[t]}}),Object.defineProperty(e,i,n)}:function(e,r,t,i){i===void 0&&(i=t),e[i]=r[t]}),ye=E&&E.__exportStar||function(e,r){for(var t in e)t!=="default"&&!Object.prototype.hasOwnProperty.call(r,t)&&_e(r,e,t)};Object.defineProperty(E,"__esModule",{value:!0});ye(H(),E)});var B=u(_=>{"use strict";var Ae=_&&_.__createBinding||(Object.create?function(e,r,t,i){i===void 0&&(i=t);var n=Object.getOwnPropertyDescriptor(r,t);(!n||("get"in n?!r.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return r[t]}}),Object.defineProperty(e,i,n)}:function(e,r,t,i){i===void 0&&(i=t),e[i]=r[t]}),Pe=_&&_.__exportStar||function(e,r){for(var t in e)t!=="default"&&!Object.prototype.hasOwnProperty.call(r,t)&&Ae(r,e,t)};Object.defineProperty(_,"__esModule",{value:!0});Pe(V(),_)});var J=u(d=>{"use strict";Object.defineProperty(d,"__esModule",{value:!0});d.PlaylistEpisodeServerSkipType=d.PlaylistEpisodeServerSubtitleFormat=d.PlaylistEpisodeServerFormatType=d.PlaylistEpisodeServerQualityType=void 0;var x;(function(e){e[e.auto=0]="auto",e[e.q360p=1]="q360p",e[e.q480p=2]="q480p",e[e.q720p=3]="q720p",e[e.q1080p=4]="q1080p"})(x||(d.PlaylistEpisodeServerQualityType=x={}));var Y;(function(e){e[e.hsl=0]="hsl",e[e.dash=1]="dash"})(Y||(d.PlaylistEpisodeServerFormatType=Y={}));var W;(function(e){e[e.vtt=0]="vtt",e[e.ass=1]="ass",e[e.srt=2]="srt"})(W||(d.PlaylistEpisodeServerSubtitleFormat=W={}));var K;(function(e){e[e.opening=0]="opening",e[e.ending=1]="ending",e[e.recap=2]="recap"})(K||(d.PlaylistEpisodeServerSkipType=K={}))});var Z=u(y=>{"use strict";var me=y&&y.__createBinding||(Object.create?function(e,r,t,i){i===void 0&&(i=t);var n=Object.getOwnPropertyDescriptor(r,t);(!n||("get"in n?!r.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return r[t]}}),Object.defineProperty(e,i,n)}:function(e,r,t,i){i===void 0&&(i=t),e[i]=r[t]}),he=y&&y.__exportStar||function(e,r){for(var t in e)t!=="default"&&!Object.prototype.hasOwnProperty.call(r,t)&&me(r,e,t)};Object.defineProperty(y,"__esModule",{value:!0});he(J(),y)});var z=u(A=>{"use strict";var be=A&&A.__createBinding||(Object.create?function(e,r,t,i){i===void 0&&(i=t);var n=Object.getOwnPropertyDescriptor(r,t);(!n||("get"in n?!r.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return r[t]}}),Object.defineProperty(e,i,n)}:function(e,r,t,i){i===void 0&&(i=t),e[i]=r[t]}),Ne=A&&A.__exportStar||function(e,r){for(var t in e)t!=="default"&&!Object.prototype.hasOwnProperty.call(r,t)&&be(r,e,t)};Object.defineProperty(A,"__esModule",{value:!0});Ne(Z(),A)});var te=u(l=>{"use strict";Object.defineProperty(l,"__esModule",{value:!0});l.PlaylistPreviewType=l.PlaylistType=l.PlaylistStatus=l.DiscoverListingOrientationType=l.DiscoverListingType=void 0;var X;(function(e){e[e.default=0]="default",e[e.rank=1]="rank",e[e.featured=2]="featured"})(X||(l.DiscoverListingType=X={}));var Q;(function(e){e[e.portrait=0]="portrait",e[e.landscape=1]="landscape"})(Q||(l.DiscoverListingOrientationType=Q={}));var G;(function(e){e[e.unknown=0]="unknown",e[e.upcoming=1]="upcoming",e[e.ongoing=2]="ongoing",e[e.completed=3]="completed",e[e.paused=4]="paused",e[e.cancelled=5]="cancelled"})(G||(l.PlaylistStatus=G={}));var k;(function(e){e[e.video=0]="video",e[e.image=1]="image",e[e.text=2]="text"})(k||(l.PlaylistType=k={}));var ee;(function(e){e[e.video=0]="video",e[e.image=1]="image"})(ee||(l.PlaylistPreviewType=ee={}))});var ie=u(g=>{"use strict";var ve=g&&g.__createBinding||(Object.create?function(e,r,t,i){i===void 0&&(i=t);var n=Object.getOwnPropertyDescriptor(r,t);(!n||("get"in n?!r.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return r[t]}}),Object.defineProperty(e,i,n)}:function(e,r,t,i){i===void 0&&(i=t),e[i]=r[t]}),Se=g&&g.__exportStar||function(e,r){for(var t in e)t!=="default"&&!Object.prototype.hasOwnProperty.call(r,t)&&ve(r,e,t)};Object.defineProperty(g,"__esModule",{value:!0});g.SourceModule=void 0;Se(te(),g);var C=class{};g.SourceModule=C});var re=u(R=>{"use strict";Object.defineProperty(R,"__esModule",{value:!0});R.TrackerModule=void 0;var T=class{constructor(){this.metadata={}}};R.TrackerModule=T});var ae=u(f=>{"use strict";var De=f&&f.__createBinding||(Object.create?function(e,r,t,i){i===void 0&&(i=t);var n=Object.getOwnPropertyDescriptor(r,t);(!n||("get"in n?!r.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return r[t]}}),Object.defineProperty(e,i,n)}:function(e,r,t,i){i===void 0&&(i=t),e[i]=r[t]}),ne=f&&f.__exportStar||function(e,r){for(var t in e)t!=="default"&&!Object.prototype.hasOwnProperty.call(r,t)&&De(r,e,t)};Object.defineProperty(f,"__esModule",{value:!0});ne(ie(),f);ne(re(),f)});var oe=u(p=>{"use strict";var Re=p&&p.__createBinding||(Object.create?function(e,r,t,i){i===void 0&&(i=t);var n=Object.getOwnPropertyDescriptor(r,t);(!n||("get"in n?!r.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return r[t]}}),Object.defineProperty(e,i,n)}:function(e,r,t,i){i===void 0&&(i=t),e[i]=r[t]}),M=p&&p.__exportStar||function(e,r){for(var t in e)t!=="default"&&!Object.prototype.hasOwnProperty.call(r,t)&&Re(r,e,t)};Object.defineProperty(p,"__esModule",{value:!0});M(U(),p);M(B(),p);M(z(),p);M(ae(),p)});var Me={};ge(Me,{default:()=>L});var o=fe(oe());async function se(e){return console.log("Fetching from "+e+"..."),await(await request.get(e)).json()}var h="https://anify.tv",I="https://api.anify.tv",L=class extends o.SourceModule{constructor(){super(...arguments);this.metadata={id:"AnifySource",name:"Anify Source",version:"1.0.0"}}async searchFilters(){return[{id:"genres",displayName:"Genres",multiselect:!0,options:[],required:!1},{id:"tags",displayName:"Tags",multiselect:!0,options:[],required:!1}]}async search(t){let i=await(await request.get(`${I}/search?query=${encodeURIComponent(t.query)}&type=anime&page=${t.page??1}`)).json(),n=i.results.map(s=>({id:s.id,url:`${h}/info/${s.id}`,status:s.status==="CANCELLED"?o.PlaylistStatus.cancelled:s.status==="FINISHED"?o.PlaylistStatus.completed:s.status==="HIATUS"?o.PlaylistStatus.paused:s.status==="NOT_YET_RELEASED"?o.PlaylistStatus.upcoming:s.status==="RELEASING"?o.PlaylistStatus.ongoing:o.PlaylistStatus.unknown,type:o.PlaylistType.video,title:s.title.english??s.title.romaji??s.title.native??"Unknown",bannerImage:s.bannerImage??s.coverImage??void 0,posterImage:s.coverImage??s.bannerImage??void 0})),P=i.lastPage>Number(t.page??1);return{id:`${I}/search?query=${t.query}&type=anime&page=${t.page??1}`,nextPage:P?`${I}/search?query=${t.query}&type=anime&page=${Number(t.page??1)+1}`:void 0,items:n,previousPage:`${I}/search?query=${t.query}&type=anime&page=${Number(t.page??1)-1}`,title:"Test"}}async discoverListings(t){let i=await(await request.get(`${I}/seasonal?type=anime&fields=[id,description,bannerImage,coverImage,title,genres,format,status,averageRating,episodes,chapters,year,type]`)).json(),n=i.seasonal.map(a=>({id:a.id,url:`${h}/info/${a.id}`,status:a.status==="CANCELLED"?o.PlaylistStatus.cancelled:a.status==="FINISHED"?o.PlaylistStatus.completed:a.status==="HIATUS"?o.PlaylistStatus.paused:a.status==="NOT_YET_RELEASED"?o.PlaylistStatus.upcoming:a.status==="RELEASING"?o.PlaylistStatus.ongoing:o.PlaylistStatus.unknown,type:o.PlaylistType.video,title:a.title.english??a.title.romaji??a.title.native??"Unknown",bannerImage:a.bannerImage??a.coverImage??void 0,posterImage:a.coverImage??a.bannerImage??void 0})),P=i.top.map(a=>({id:a.id,url:`${h}/info/${a.id}`,status:a.status==="CANCELLED"?o.PlaylistStatus.cancelled:a.status==="FINISHED"?o.PlaylistStatus.completed:a.status==="HIATUS"?o.PlaylistStatus.paused:a.status==="NOT_YET_RELEASED"?o.PlaylistStatus.upcoming:a.status==="RELEASING"?o.PlaylistStatus.ongoing:o.PlaylistStatus.unknown,type:o.PlaylistType.video,title:a.title.english??a.title.romaji??a.title.native??"Unknown",bannerImage:a.bannerImage??a.coverImage??void 0,posterImage:a.coverImage??a.bannerImage??void 0})),s=i.popular.map(a=>({id:a.id,url:`${h}/info/${a.id}`,status:a.status==="CANCELLED"?o.PlaylistStatus.cancelled:a.status==="FINISHED"?o.PlaylistStatus.completed:a.status==="HIATUS"?o.PlaylistStatus.paused:a.status==="NOT_YET_RELEASED"?o.PlaylistStatus.upcoming:a.status==="RELEASING"?o.PlaylistStatus.ongoing:o.PlaylistStatus.unknown,type:o.PlaylistType.video,title:a.title.english??a.title.romaji??a.title.native??"Unknown",bannerImage:a.bannerImage??a.coverImage??void 0,posterImage:a.coverImage??a.bannerImage??void 0})),b=i.trending.map(a=>({id:a.id,url:`${h}/info/${a.id}`,status:a.status==="CANCELLED"?o.PlaylistStatus.cancelled:a.status==="FINISHED"?o.PlaylistStatus.completed:a.status==="HIATUS"?o.PlaylistStatus.paused:a.status==="NOT_YET_RELEASED"?o.PlaylistStatus.upcoming:a.status==="RELEASING"?o.PlaylistStatus.ongoing:o.PlaylistStatus.unknown,type:o.PlaylistType.video,title:a.title.english??a.title.romaji??a.title.native??"Unknown",bannerImage:a.bannerImage??a.coverImage??void 0,posterImage:a.coverImage??a.bannerImage??void 0}));return[{title:"Trending",type:2,id:"trending",orientation:0,paging:{id:"currently-trending",title:"Trending",previousPage:void 0,nextPage:void 0,items:b}},{title:"Seasonal",type:1,id:"seasonal",orientation:0,paging:{id:"seasonal-anime",title:"Seasonal",previousPage:void 0,nextPage:void 0,items:n}}]}async playlistDetails(t){let i=await(await request.get(`${I}/info/${t}`)).json();return{synopsis:i.description??"No description found.",genres:i.genres,yearReleased:i.year??0,previews:[],altBanners:i.artwork.filter(n=>n.type==="banner"||n.type==="top_banner").map(n=>n.img),altPosters:i.artwork.filter(n=>n.type==="poster").map(n=>n.img),altTitles:Object.values(i.title).filter(Boolean),ratings:i.averageRating??0}}async playlistEpisodeServer(t){let i=await se(`${t.episodeId}`);return{links:i.sources.map(n=>({url:n.url,quality:o.PlaylistEpisodeServerQualityType.auto,format:o.PlaylistEpisodeServerFormatType.dash})),skipTimes:[{startTime:i.intro.start,endTime:i.intro.end,type:o.PlaylistEpisodeServerSkipType.opening},{startTime:i.outro.start,endTime:i.outro.end,type:o.PlaylistEpisodeServerSkipType.ending}],headers:i.headers,subtitles:i.subtitles.map(n=>({url:n.url,name:n.label??n.lang??"Unknown",format:n.url.endsWith("vtt")?o.PlaylistEpisodeServerSubtitleFormat.vtt:n.url.endsWith("ass")?o.PlaylistEpisodeServerSubtitleFormat.ass:n.url.endsWith("srt")?o.PlaylistEpisodeServerSubtitleFormat.srt:o.PlaylistEpisodeServerSubtitleFormat.vtt,default:!!(n.lang==="en-US"||n.lang?.toLowerCase().includes("english")),autoselect:!0}))}}async playlistEpisodeSources(t){return[{id:"servers",servers:[{id:"main",displayName:"Main"}],displayName:"Servers"}]}async playlistEpisodes(t,i){let n=await(await request.get(`${I}/episodes?id=${t}`)).json(),P=[];for(let s of n){let b=[],a=s.episodes,j=a.map((N,c)=>c%12===0&&a.slice(c,c+12)).filter(Boolean);for(let N=0;N<j.length;N++){let c=j[N];if(c)try{let v={id:`${t}-${s.providerId}`,title:`${c[0].number}-${c[c.length-1].number}`,items:[]};for(let m of c)v.items.push({id:`${I}/sources?id=${t}&providerId=${s.providerId}&watchId=${m.id}&subType=sub&episodeNumber=${m.number}`,title:m.number.toString(),number:m.number,description:m.description??void 0,thumbnail:m.img??void 0,tags:[]});b.push(v)}catch(v){console.error(v),console.log(c)}}P.push({id:`${t}-${s.providerId}`,title:s.providerId,pagings:b})}return[{id:t,number:1,variants:P}]}};return Ie(Me);})();
